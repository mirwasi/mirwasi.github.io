<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.79.1"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta property="og:title" content="Locale-Sensitive Number Formatting in Java"><meta name=keywords content="java,gotcha"><meta name=description content="Locale-Sensitive Number Formatting in Java While working on a piece of code, I encountered an issue that I thought was worth sharing. The …"><meta property="og:title" content="Locale-Sensitive Number Formatting in Java"><meta property="og:description" content="Locale-Sensitive Number Formatting in Java While working on a piece of code, I encountered an issue that I thought was worth sharing. The task seemed straightforward: generate a file path that includes an integer ID. Here&rsquo;s a simplified version of the code:
// id - arbitrary integer int id = 123; // Expected output: /tmp/app-files/123 String path = String.format(Locale.getDefault(), &#34;/tmp/app-files/%d&#34;, id); At first glance, this looks simple and works fine—as long as your locale uses Western Arabic Numerals (Unicode/ASCII 0x30 to 0x39)."><meta property="og:type" content="article"><meta property="og:url" content="http://mirwasi.co.uk/posts/locale-sensitive-number-formatting-in-java/"><meta property="article:published_time" content="2024-08-15T00:00:00+00:00"><meta property="article:modified_time" content="2024-08-15T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Locale-Sensitive Number Formatting in Java"><meta name=twitter:description content="Locale-Sensitive Number Formatting in Java While working on a piece of code, I encountered an issue that I thought was worth sharing. The task seemed straightforward: generate a file path that includes an integer ID. Here&rsquo;s a simplified version of the code:
// id - arbitrary integer int id = 123; // Expected output: /tmp/app-files/123 String path = String.format(Locale.getDefault(), &#34;/tmp/app-files/%d&#34;, id); At first glance, this looks simple and works fine—as long as your locale uses Western Arabic Numerals (Unicode/ASCII 0x30 to 0x39)."><link rel=stylesheet type=text/css media=screen href=/css/normalize.css><link rel=stylesheet type=text/css media=screen href=/css/main.css><link rel=stylesheet type=text/css media=screen href=/css/all.css><link rel=stylesheet href=/css/katex.min.css crossorigin=anonymous><script defer src=/js/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=/js/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body);></script><title>Locale-Sensitive Number Formatting in Java | Mir Wasi Ahmed</title></head><body><header><div id=titletext><h2 id=title><a href=http://mirwasi.co.uk>Mir Wasi Ahmed</a></h2></div><div id=title-description><p id=subtitle>Software Engineer based in London, with a wide range of interests. A <em>dilettante</em>.</p><div id=social><nav><ul><li><a href=https://www.twitter.com/wasiahmed><i title=Twitter class="icons fab fa-twitter"></i></a></li><li><a href=/index.xml><i title=RSS class="icons fas fa-rss"></i></a></li></ul></nav></div></div><div id=mainmenu><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/about>About</a></li><li><a href=/links>Links</a></li><li><a href=/tags>Tags</a></li></ul></nav></div></header><main><div class=post><div class=author></div><div class=post-header><div class=meta><div class=date><span class=day>15</span>
<span class=rest>Aug 2024</span></div></div><div class=matter><h1 class=title>Locale-Sensitive Number Formatting in Java</h1></div></div><div class=markdown><h3 id=locale-sensitive-number-formatting-in-java>Locale-Sensitive Number Formatting in Java</h3><p>While working on a piece of code, I encountered an issue that I thought was worth sharing. The task seemed straightforward: generate a file path that includes an integer ID. Here&rsquo;s a simplified version of the code:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#888>// id - arbitrary integer
</span><span style=color:#888></span><span style=color:#339;font-weight:700>int</span> id <span style=color:#333>=</span> 123<span style=color:#333>;</span>
<span style=color:#888>// Expected output: /tmp/app-files/123
</span><span style=color:#888></span>String path <span style=color:#333>=</span> String<span style=color:#333>.</span><span style=color:#00c>format</span><span style=color:#333>(</span>Locale<span style=color:#333>.</span><span style=color:#00c>getDefault</span><span style=color:#333>(),</span> <span style=background-color:#fff0f0>&#34;/tmp/app-files/%d&#34;</span><span style=color:#333>,</span> id<span style=color:#333>);</span>

</code></pre></div><p>At first glance, this looks simple and works fine—<strong>as long as your locale uses <a href=https://en.wikipedia.org/wiki/Arabic_numerals target=_blank>Western Arabic Numerals</a></strong> (Unicode/ASCII 0x30 to 0x39). However, things take an unexpected turn when your locale uses a different numeral system, such as Bengali.</p><p>For instance, the Bengali numerals are:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>০	১	২	৩	৪	৫	৬	৭	৮	৯
</code></pre></div><p>If your locale is set to Bengali, the generated path would look like:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>/tmp/app-files/১২৩
</code></pre></div><p>This output might not be what you expected, especially if you require the path to strictly use Western Arabic numerals.</p><h3 id=the-solution-use-localeus>The Solution: Use Locale.US</h3><p>To avoid this issue and ensure consistent formatting across different locales, it&rsquo;s better to use <code>Locale.US</code> when formatting numbers for paths or similar cases where the output should remain consistent regardless of the user&rsquo;s locale:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>String path <span style=color:#333>=</span> String<span style=color:#333>.</span><span style=color:#00c>format</span><span style=color:#333>(</span>Locale<span style=color:#333>.</span><span style=color:#00c>US</span><span style=color:#333>,</span> <span style=background-color:#fff0f0>&#34;/tmp/app-files/%d&#34;</span><span style=color:#333>,</span> id<span style=color:#333>);</span>
</code></pre></div><p>Now, regardless of the locale, the path will be correctly formatted as:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>/tmp/app-files/123
</code></pre></div><p>This approach ensures that your code behaves predictably in environments with different locale settings.</p><p>Thanks for reading!</p></div><div class=tags><div class=taxosfloating_left><p>Tags</p></div><div class=termsfloating_right><p><a href=/tags/gotcha/>gotcha</a>
<a href=/tags/java/>java</a></p></div><div class=clearit></div></div></div></main><footer>© 2023 - 2024, Mir Wasi Ahmed
<script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-153851003-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></footer></body></html>